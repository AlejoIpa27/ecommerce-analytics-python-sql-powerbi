-- DAX Measures (Power BI)
Revenue := SUM(fact_sales[line_revenue])
Cost := SUM(fact_sales[line_cost])
Profit := SUM(fact_sales[line_profit])
Orders := DISTINCTCOUNT(fact_sales[order_id])
Customers := DISTINCTCOUNT(fact_sales[customer_id])

-- Time intelligence (requires Calendar table related to fact_sales[order_date])
Revenue PY := CALCULATE([Revenue], DATEADD('Calendar'[Date], -1, YEAR))
Revenue MoM % := DIVIDE([Revenue] - CALCULATE([Revenue], DATEADD('Calendar'[Date], -1, MONTH)), CALCULATE([Revenue], DATEADD('Calendar'[Date], -1, MONTH)))
Profit Margin % := DIVIDE([Profit], [Revenue])

AOV (Avg Order Value) := DIVIDE([Revenue], [Orders])
Repeat Customers := CALCULATE(DISTINCTCOUNT(fact_sales[customer_id]), FILTER(VALUES(fact_sales[customer_id]), CALCULATE(DISTINCTCOUNT(fact_sales[order_id])) >= 2))